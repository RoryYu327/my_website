---
title: "Biden's Approval Margins"
author: "Rory Yu"
date: "2021-09-20"
categories: R
tags:
- R Markdown
- plot
---

<script src="Challenge 1_files/header-attrs/header-attrs.js"></script>


<div id="bidens-approval-margins" class="section level1">
<h1>Biden’s Approval Margins</h1>
<p>www.fivethirtyeight.com has detailed data on [all polls that track the president’s approval]
(<a href="https://projects.fivethirtyeight.com/biden-approval-ratings" class="uri">https://projects.fivethirtyeight.com/biden-approval-ratings</a>)</p>
<pre class="r"><code># Import approval polls data directly off fivethirtyeight website
approval_polllist &lt;- read_csv(&#39;https://projects.fivethirtyeight.com/biden-approval-data/approval_polllist.csv&#39;) 

glimpse(approval_polllist)</code></pre>
<pre><code>## Rows: 1,598
## Columns: 22
## $ president           &lt;chr&gt; &quot;Joseph R. Biden Jr.&quot;, &quot;Joseph R. Biden Jr.&quot;, &quot;Jos~
## $ subgroup            &lt;chr&gt; &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;, &quot;All polls&quot;~
## $ modeldate           &lt;chr&gt; &quot;9/20/2021&quot;, &quot;9/20/2021&quot;, &quot;9/20/2021&quot;, &quot;9/20/2021&quot;~
## $ startdate           &lt;chr&gt; &quot;2/2/2021&quot;, &quot;2/2/2021&quot;, &quot;2/3/2021&quot;, &quot;2/4/2021&quot;, &quot;2~
## $ enddate             &lt;chr&gt; &quot;2/4/2021&quot;, &quot;2/4/2021&quot;, &quot;2/5/2021&quot;, &quot;2/6/2021&quot;, &quot;2~
## $ pollster            &lt;chr&gt; &quot;Rasmussen Reports/Pulse Opinion Research&quot;, &quot;Morni~
## $ grade               &lt;chr&gt; &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B-&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;,~
## $ samplesize          &lt;dbl&gt; 1500, 15000, 15000, 15000, 1500, 1200, 15000, 1986~
## $ population          &lt;chr&gt; &quot;lv&quot;, &quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;lv&quot;, &quot;rv&quot;, &quot;a&quot;, &quot;rv&quot;, &quot;lv&quot;, ~
## $ weight              &lt;dbl&gt; 0.338, 0.277, 0.248, 0.226, 0.178, 0.881, 0.209, 0~
## $ influence           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,~
## $ approve             &lt;dbl&gt; 49.0, 54.0, 54.0, 54.0, 50.0, 60.0, 55.0, 59.0, 51~
## $ disapprove          &lt;dbl&gt; 48.0, 34.0, 34.0, 34.0, 47.0, 32.0, 33.0, 35.0, 46~
## $ adjusted_approve    &lt;dbl&gt; 51.5, 52.7, 52.7, 52.7, 52.5, 59.2, 53.7, 57.7, 53~
## $ adjusted_disapprove &lt;dbl&gt; 42.0, 37.3, 37.3, 37.3, 41.0, 33.2, 36.3, 38.3, 40~
## $ multiversions       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA~
## $ tracking            &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, NA, TRUE, NA, TRUE, ~
## $ url                 &lt;chr&gt; &quot;https://www.rasmussenreports.com/public_content/p~
## $ poll_id             &lt;dbl&gt; 74347, 74367, 74368, 74369, 74349, 74354, 74372, 7~
## $ question_id         &lt;dbl&gt; 139654, 139734, 139735, 139736, 139669, 139679, 13~
## $ createddate         &lt;chr&gt; &quot;2/5/2021&quot;, &quot;2/11/2021&quot;, &quot;2/11/2021&quot;, &quot;2/11/2021&quot;,~
## $ timestamp           &lt;chr&gt; &quot;13:32:09 20 Sep 2021&quot;, &quot;13:32:09 20 Sep 2021&quot;, &quot;1~</code></pre>
<pre class="r"><code># Use `lubridate` to fix dates, as they are given as characters.
approval_polllist &lt;- approval_polllist %&gt;% 
  mutate(enddate = mdy(enddate))</code></pre>
<div id="create-a-plot" class="section level2">
<h2>Create a plot</h2>
<p>What I would like you to do is to calculate the average net approval rate (approve- disapprove) for each week since he got into office. I want you plot the net approval, along with its 95% confidence interval. There are various dates given for each poll, please use <code>enddate</code>, i.e., the date the poll ended.</p>
<p>Also, please add an orange line at zero. Your plot should look like this:</p>
<p><img src="E:/OneDrive - London Business School/AM01 AUT21 Applied Statistics/my_website/images/biden_approval_margin.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#tidy data and calculate CI using formula. We concentrate only on subgroup &quot;voters&quot;
net_approval &lt;- approval_polllist %&gt;% 
  filter(!is.na(subgroup), subgroup==&quot;Voters&quot;) %&gt;%
  #using lubridate to get week number
  mutate(week = isoweek(enddate),
         net_approval_day = approve - disapprove) %&gt;% 
  group_by(week) %&gt;%
  summarise(mean_net_approval = mean(net_approval_day),
            sd_net_approval = sd(net_approval_day),
            count = n(),
            se_twitter = sd_net_approval / sqrt(count),
            t_critical = qt(0.975, count - 1),
            lower_ci =  mean_net_approval - t_critical*se_twitter,
            upper_ci = mean_net_approval + t_critical*se_twitter)</code></pre>
<pre class="r"><code>#plot Biden&#39;s weekly net approval rate
ggplot(net_approval, 
       aes(x= week, 
           y= mean_net_approval)) +
  geom_line(color = &quot;red&quot;)+
  geom_point(color = &quot;red&quot;, size = 1)+
  geom_smooth(color = &quot;blue&quot;,
              level = 0,
              size = 1)+
  #add orange line at zero
  geom_hline(yintercept=0, 
             color = &quot;orange&quot;, 
             size = 2)+
  theme_minimal()+
  #add confidence band using calculated CI
  geom_ribbon(aes(ymin = lower_ci, 
                  ymax = upper_ci),
              alpha=0.3,
              fill = &quot;grey&quot;,
              color = &quot;red&quot;) + 
  labs(
    title = &quot;Estimating Approval Margin (approve-disapprove) for Joe Biden&quot;,
    subtitle = &quot;Weekly average approval of subgroup \&quot;Voters\&quot;&quot;,
    x = &quot;Week of the year&quot;,
    y = &quot;Average Approval Margin (approve-disapprove)&quot;)+
  scale_y_continuous(breaks=seq(-15,10,2.5), limits=c(-15,40))+
  scale_x_continuous(breaks=seq(0,40,13))+
  theme(
    axis.text.x = element_text(size = 18),
    axis.text.y = element_text(size = 18),
    axis.title.x = element_text(size=22, face=&quot;bold&quot;),
    axis.title.y = element_text(size=22, face=&quot;bold&quot;),
    plot.title = element_text(size = 22, face=&quot;bold&quot;),
    plot.subtitle = element_text(size=20, face=&quot;bold&quot;)
  )+
   annotate(&quot;text&quot;, x=19.5, y=20, label=&quot;2021&quot;, color = &quot;#333333&quot;, size=8)</code></pre>
<p><img src="/post/Challenge%201_files/figure-html/Biden%20net%20approval%20rate%20plot-1.png" width="2496" style="display: block; margin: auto;" /></p>
</div>
<div id="compare-confidence-intervals" class="section level2">
<h2>Compare Confidence Intervals</h2>
<p>Compare the confidence intervals for <code>week 4</code> and <code>week 25</code>.</p>
<pre class="r"><code>net_approval_4_25 &lt;- net_approval %&gt;% 
  filter(week %in% c(4, 25)) %&gt;% 
  mutate(
    ci_width = upper_ci - lower_ci) %&gt;% 
  select(week, lower_ci, upper_ci, ci_width)

net_approval_4_25</code></pre>
<pre><code>## # A tibble: 1 x 4
##    week lower_ci upper_ci ci_width
##   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1    25     3.61     10.5     6.85</code></pre>
<blockquote>
<p>Can you explain what’s going on? One paragraph would be enough.</p>
</blockquote>
<p>From the results, we can clearly see that the confidence interval for Biden’s net approval rate has been narrower from week 4 to week 25. The standard deviation in approval ratings is much larger in week 4 than in week 25, which generates a higher standard error and consequently a wider confidence interval. We assume this is because as after Biden has been elected for a longer period of time in week 25 (almost half a year), voters would become more clear about their approval or disapproval to the president. After Americans took over 25-week time to evaluate their newly elected president, they would probably have a clearer attitude towards Biden’s policy changes, administration and national strategies. These clearer perceptions then result in this decreasing variance in approval ratings, consequently a lower standard deviation and ultimately more narrow confidence intervals.</p>
</div>
</div>
